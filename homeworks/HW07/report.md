# HW07 – Report

## 1. Datasets

### 1.1 Dataset A (S07-hw-dataset-02.csv)

- Файл:                 `S07-hw-dataset-02.csv`
- Размер:               (8000, 4)
- Признаки:             Все числовые (`float64`), пропусков нет.
- Неточности датасета:  Нелинейная структура кластеров (не сферы, а сложные формы), наличие шума (`z_noise`).

### 1.2 Dataset B (S07-hw-dataset-03.csv)

- Файл:                  `S07-hw-dataset-03.csv`
- Размер:                (15000, 5)
- Признаки:              Все числовые (`float64`), пропусков нет.
- Неточности датасета:   Кластеры разной плотности и вытянутой формы, наличие фонового шума.

### 1.3 Dataset C (S07-hw-dataset-04.csv)

- Файл:                  `S07-hw-dataset-04.csv`
- Размер:                (10000, 33)
- Признаки:              Смешанные (31 числовой, 2 категориальных).
- Пропуски:              Есть в числовых колонках (около 2%).
- Неточности датасета:   Высокая размерность, наличие категориальных признаков (текст), пропуски в данных.

## 2. Protocol

-   Препроцессинг:  
    - Удаление колонки `sample_id`.
    - Для   Dataset C (ds4)  : удаление категориальных колонок (`cat_a`, `cat_b`) и заполнение пропусков средним значением (`SimpleImputer(strategy='mean')`).
    - Для всех датасетов: масштабирование признаков с помощью `StandardScaler`.
-   Поиск гиперпараметров:  
    -   KMeans:  перебор `k` в диапазоне от 2 до 9.
    - DBSCAN: перебор `eps` в диапазоне от 0.2 до 1.5 с шагом 0.1 (`min_samples=5`).
    - Критерий выбора: Максимизация метрики `Silhouette Score` при условии, что кластеров больше 1.
- Метрики:
    - `silhouette_score` (основная), `davies_bouldin_score`, `calinski_harabasz_score`.
    - Для DBSCAN метрики считались по всем точкам (включая шум, помеченный как -1, чтобы штрафовать алгоритм за плохую разметку).
- Визуализация: PCA (2 компоненты) для отображения финального разбиения.

## 3. Models

На каждом датасете сравнивались:

1. KMeans:
   - Параметры: поиск `n_clusters`, фиксировали `random_state=42`, `n_init=10`.
2. DBSCAN:
   - Параметры: поиск `eps`, фиксировали `min_samples=5`.

## 4. Results

### 4.1 Dataset A (ds2)

- Лучший метод: DBSCAN (`eps=1.1`)
- Метрики: Silhouette = 0.531 (KMeans показал 0.307).
- Комментарий: KMeans пытался разбить данные на сферы, разрезав естественные кластеры. DBSCAN корректно выделил плотные области сложной формы.

### 4.2 Dataset B (ds3)

- Лучший метод: DBSCAN (`eps=1.1`)
- Метрики: Silhouette = 0.490 (KMeans показал 0.316).
- Комментарий: Из-за вытянутой формы и разной плотности кластеров центроидный метод (KMeans) сработал хуже, чем плотностной (DBSCAN).

### 4.3 Dataset C (ds4)

- Лучший метод: KMeans (`k=5`)
- Метрики: Silhouette = 0.456 (DBSCAN показал отрицательный результат -0.018).
- Комментарий: В пространстве высокой размерности DBSCAN не смог подобрать плотность (либо всё шум, либо всё один кластер). KMeans отлично нашел 5 сферических сгустков.

## 5. Analysis

### 5.1 Сравнение алгоритмов

- KMeans "ломается" на датасетах со сложной геометрией (`ds2`, `ds3`), так как он всегда стремится найти выпуклые (сферические) кластеры.
- DBSCAN выигрывает там, где кластеры имеют неправильную форму или есть шум, но проигрывает на данных высокой размерности (`ds4`) из-за "проклятия размерности" (расстояния между точками становятся неинформативными).
- Влияние факторов: Критически важным оказалось масштабирование (StandardScaler) и обработка пропусков для `ds4`. Без этого модели бы не обучились.

### 5.2 Устойчивость

- Проверка: 5 запусков KMeans на датасете `ds1` с разными `random_state` (seed).
- Результат: Стандартное отклонение метрики Silhouette составило `0.00000`.
- Вывод: Решение абсолютно устойчиво. На синтетических данных с хорошо разделенными кластерами KMeans всегда сходится к одному и тому же глобальному оптимуму.

### 5.3 Интерпретация кластеров

- Интерпретация: Кластеры интерпретировались визуально через проекцию PCA (2D).
- Вывод:
   - На `ds4` четко видно 5 разделимых групп, что подтверждает правильность выбора `k=5`.
   - На `ds2` и `ds3` визуализация подтвердила, что DBSCAN следует за формой данных, а не режет их прямыми линиями.

## 6. Conclusion

1. Нет универсального алгоритма: Для геометрии нужен DBSCAN, для простых "шаров" и высокой размерности — KMeans.
2. Важность препроцессинга: Реальные данные (как в `ds4`) требуют очистки и импутации перед кластеризацией.
3. Метрики не врут: Silhouette Score корректно подсказал лучший метод во всех трех случаях, что подтвердилось визуализацией.
4. Протокол: Честный эксперимент требует перебора параметров, так как дефолтные настройки (например, `eps=0.5`) часто не работают.